---
- hosts: all
  gather_facts: false
  tasks:
    - name: Déploiement du docker-compose
      community.docker.docker_compose_v2:
        definition: "{{ compose_definition }}"
        project_name: "{{ compose_project }}"
        pull: if_not_present
      tags: create

    - name: Arrêt des conteneurs
      ansible.builtin.command: "docker compose -p {{ compose-project }} kill"
      tags: delete

    - name: Suppression du docker-compose
      community.docker.docker_compose_v2:
        definition: "{{ compose_definition }}"
        project_name: "{{ compose-project }}"
        state: absent
      tags: delete
